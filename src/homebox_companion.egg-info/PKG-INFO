Metadata-Version: 2.4
Name: homebox-companion
Version: 1.0.0
Summary: AI-powered companion app for Homebox - detect and catalog household items from photos
License: MIT
Project-URL: Repository, https://github.com/yourusername/homebox-companion
Project-URL: Documentation, https://github.com/yourusername/homebox-companion#readme
Keywords: homebox,inventory,ai,vision,openai,home-inventory
Classifier: Development Status :: 4 - Beta
Classifier: Environment :: Web Environment
Classifier: Framework :: FastAPI
Classifier: Intended Audience :: End Users/Desktop
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Home Automation
Requires-Python: >=3.12
Description-Content-Type: text/markdown
Requires-Dist: openai>=2.8.1
Requires-Dist: httpx>=0.27.0
Requires-Dist: fastapi>=0.115.0
Requires-Dist: uvicorn[standard]>=0.32.0
Requires-Dist: python-multipart>=0.0.17
Requires-Dist: loguru>=0.7.3

# Homebox Vision Companion

üè†üì∏ **AI-powered item detection for [Homebox](https://github.com/sysadminsmedia/homebox) inventory management.**

Take a photo of your stuff, and let AI identify and catalog items directly into your Homebox instance. Perfect for quickly inventorying a room, shelf, or collection.

## Features

- üì∑ **Photo-based Detection** ‚Äì Upload or capture photos of items
- ü§ñ **AI Vision Analysis** ‚Äì Uses OpenAI GPT-4o to identify items in images
- üè∑Ô∏è **Smart Labeling** ‚Äì Automatically suggests labels from your Homebox labels
- üìç **Hierarchical Locations** ‚Äì Navigate your location tree to place items
- ‚úèÔ∏è **Review & Edit** ‚Äì Edit AI suggestions before saving
- üîÄ **Merge Items** ‚Äì Combine multiple detected items into one
- üîß **AI Corrections** ‚Äì Tell the AI what it got wrong and it will fix it
- üì± **Mobile-First UI** ‚Äì Designed for phones (works on desktop too)

## Quick Start

### Prerequisites

- Python 3.12+
- [uv](https://docs.astral.sh/uv/) (recommended) or pip
- An OpenAI API key ([get one here](https://platform.openai.com/api-keys))
- A Homebox instance (or use the demo server)

### Installation

```bash
# Clone the repository
git clone https://github.com/yourusername/homebox-vision.git
cd homebox-vision

# Create virtual environment and install dependencies
uv venv
uv sync

# Or with pip
python -m venv .venv
source .venv/bin/activate  # On Windows: .venv\Scripts\activate
pip install -e .
```

### Configuration

Set the required environment variables:

**Linux/macOS:**
```bash
# Required: Your OpenAI API key
export HOMEBOX_VISION_OPENAI_API_KEY="sk-your-api-key-here"

# Required: Your Homebox API URL
export HOMEBOX_VISION_API_URL="https://your-homebox.example.com/api/v1"

# Optional: OpenAI model (default: gpt-5-mini)
export HOMEBOX_VISION_OPENAI_MODEL="gpt-5-mini"

# Optional: Server configuration
export HOMEBOX_VISION_SERVER_HOST="0.0.0.0"
export HOMEBOX_VISION_SERVER_PORT="8000"

# Optional: Log level (DEBUG, INFO, WARNING, ERROR)
export HOMEBOX_VISION_LOG_LEVEL="INFO"
```

**Windows (PowerShell):**
```powershell
$env:HOMEBOX_VISION_OPENAI_API_KEY = "sk-your-api-key-here"
$env:HOMEBOX_VISION_API_URL = "https://your-homebox.example.com/api/v1"
```

### Running the App

```bash
# Using uv
uv run python -m server.main

# Or with the CLI command (after pip install -e .)
homebox-vision

# Or with uvicorn directly
uv run uvicorn server.main:app --reload --host 0.0.0.0 --port 8000
```

Open `http://localhost:8000` in your browser.

## Environment Variables Reference

All environment variables use the `HOMEBOX_VISION_` prefix to avoid conflicts with other applications.

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `HOMEBOX_VISION_OPENAI_API_KEY` | ‚úÖ Yes | - | Your OpenAI API key |
| `HOMEBOX_VISION_API_URL` | ‚úÖ Yes | Demo server | Your Homebox API URL |
| `HOMEBOX_VISION_OPENAI_MODEL` | No | `gpt-5-mini` | OpenAI model for vision |
| `HOMEBOX_VISION_SERVER_HOST` | No | `0.0.0.0` | Server bind address |
| `HOMEBOX_VISION_SERVER_PORT` | No | `8000` | Server port |
| `HOMEBOX_VISION_LOG_LEVEL` | No | `INFO` | Logging level |

## Usage

1. **Login** ‚Äì Enter your Homebox credentials
2. **Select Location** ‚Äì Navigate your location hierarchy to choose where items will be stored
3. **Capture/Upload Photo** ‚Äì Take or upload a photo of items
4. **Review Detection** ‚Äì AI identifies items in the image
5. **Edit & Confirm** ‚Äì Adjust names, quantities, labels as needed
   - Use **Merge** to combine similar items
   - Use **Correct** to tell the AI what it got wrong
6. **Save to Homebox** ‚Äì Items are created in your inventory

## Using with Demo Server

For testing, you can use the Homebox demo server:

```bash
export HOMEBOX_VISION_API_URL="https://demo.homebox.software/api/v1"
```

Demo credentials: `demo@example.com` / `demo`

## Development

### Linting

```bash
uv run ruff check .
uv run ruff format .
```

### Testing

```bash
# Run unit tests
uv run pytest

# Run integration tests (requires API keys)
uv run pytest -m integration
```

### Project Structure

```
homebox-vision/
‚îú‚îÄ‚îÄ homebox_vision/          # Core library
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py          # Public API exports
‚îÇ   ‚îú‚îÄ‚îÄ client.py            # Homebox API client (sync + async)
‚îÇ   ‚îú‚îÄ‚îÄ config.py            # Configuration management
‚îÇ   ‚îú‚îÄ‚îÄ llm.py               # OpenAI vision integration
‚îÇ   ‚îî‚îÄ‚îÄ models.py            # Data models
‚îú‚îÄ‚îÄ server/                   # FastAPI web app
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # API routes
‚îÇ   ‚îî‚îÄ‚îÄ static/              # Frontend files
‚îÇ       ‚îú‚îÄ‚îÄ index.html
‚îÇ       ‚îú‚îÄ‚îÄ app.js
‚îÇ       ‚îî‚îÄ‚îÄ styles.css
‚îú‚îÄ‚îÄ tests/                    # Test suite
‚îú‚îÄ‚îÄ pyproject.toml           # Project configuration
‚îî‚îÄ‚îÄ README.md                # This file
```

## Library Usage

The `homebox_vision` package can also be used as a Python library:

```python
from homebox_vision import detect_items, HomeboxClient

# Detect items in an image (sync - great for scripts)
items = detect_items("photo.jpg")
for item in items:
    print(f"{item.name}: {item.quantity}")

# Create items in Homebox
with HomeboxClient(base_url="https://your-homebox/api/v1") as client:
    token = client.login("user@example.com", "password")
    locations = client.list_locations(token)
    
    for item in items:
        item.location_id = locations[0]["id"]
        client.create_item(token, item)
```

### Available Functions

```python
from homebox_vision import (
    # Configuration
    settings,
    
    # Clients (sync and async)
    HomeboxClient,
    AsyncHomeboxClient,
    
    # Models
    DetectedItem,
    
    # Detection functions
    detect_items,              # Sync - detect from file path (for scripts)
    detect_items_from_bytes,   # Async - detect from raw bytes (for servers)
    
    # Advanced AI functions (all async)
    analyze_item_details_from_images,  # Multi-image detailed analysis
    merge_items_with_openai,           # Combine similar items
    correct_item_with_openai,          # Fix detection with user feedback
    
    # Image encoding utilities
    encode_image_to_data_uri,
    encode_image_bytes_to_data_uri,
)
```

## API Endpoints

The FastAPI backend exposes these endpoints:

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/login` | Authenticate with Homebox |
| GET | `/api/locations` | List all locations |
| GET | `/api/locations/tree` | Get hierarchical location tree |
| GET | `/api/locations/{id}` | Get single location details |
| GET | `/api/labels` | List all labels |
| POST | `/api/detect` | Detect items in uploaded image |
| POST | `/api/items` | Batch create items |
| POST | `/api/analyze-advanced` | Multi-image item analysis |
| POST | `/api/merge-items` | Merge items using AI |
| POST | `/api/correct-item` | Correct item with feedback |
| POST | `/api/items/{id}/attachments` | Upload item attachment |

## Contributing

Contributions are welcome! Please ensure:

1. Code passes `ruff check .`
2. Tests pass with `pytest`
3. Increment version in `pyproject.toml`

## License

MIT License - see LICENSE file for details.

## Acknowledgments

- [Homebox](https://github.com/sysadminsmedia/homebox) - The excellent home inventory system this companion is built for
- [OpenAI](https://openai.com) - For the vision AI capabilities
- [FastAPI](https://fastapi.tiangolo.com) - The modern Python web framework
